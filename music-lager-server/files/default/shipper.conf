input {
  tcp {
    codec => json {
      charset => "UTF-8"
    }
    host => "127.0.0.1"
    port => 4420
  }
}

filter {
   json {
        source => "message"
   }
   date {
        match => [ "timestamp", "UNIX" ]
   }
   checksum {
        algorithm => "sha"
        keys => [ "timestamp", "artist", "track", "user" ]
#        add_field => { "_id" : "%{logstash_checksum}" }
   }
}

output {
  stdout {
     codec => rubydebug
   }
   redis {
     host => "127.0.0.1"
     port => 6379
     data_type => "list"
     key => "ml"
   }
}
